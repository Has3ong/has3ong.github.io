I"ğ©<h1 id="settings">Settings</h1>

<p><code class="highlighter-rouge">Setting</code> ë¶€ë¶„ì€ <a href="/fabricnetwork1">Hyperledger Fabric Network êµ¬ì„± -1-</a> ë¶€ë¶„ê³¼ ë™ì¼í•˜ë‹ˆ ë˜‘ê°™ì´ ì§„í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<p><code class="highlighter-rouge">HandOn</code> ë¶€ë¶„ë¶€í„° ë‹¤ë¦…ë‹ˆë‹¤.</p>

<h1 id="handson">HandsOn</h1>

<h2 id="bring-org3-into-the-channel-manually">Bring Org3 into the Channel Manually</h2>

<p>ì¼ë‹¨ ì œì¼ ë¨¼ì € ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬ì„±í•´ì¤ë‹ˆë‹¤. EYFN ì¦‰ ìƒˆë¡œìš´ <code class="highlighter-rouge">org</code> ë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œëŠ” ê¸°ì¡´ ë„¤íŠ¸ì›Œí¬ê°€ ë§Œë“¤ì–´ì§„ ìƒíƒœì—ì„œ ì§„í–‰í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./byfn.sh generate
<span class="nv">$ </span>./byfn.sh up
</code></pre></div></div>

<p>ëë‚˜ê³  ë‚˜ì„œ <code class="highlighter-rouge">docker ps</code> ëª…ë ¹ì–´ë¥¼ ì¹˜ë©´ ì•„ë˜ì™€ê°™ì´ ì„¤ì •ì´ ë˜ì–´ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker ps
CONTAINER ID        IMAGE                                                                                                  COMMAND                  CREATED              STATUS              PORTS                      NAMES
39969b0b38d7        dev-peer1.org2.example.com-mycc-1.0-26c2ef32838554aac4f7ad6f100aca865e87959c9a126e86d764c8d01f8346ab   <span class="s2">"chaincode -peer.addâ€¦"</span>   50 seconds ago       Up 48 seconds                                  dev-peer1.org2.example.com-mycc-1.0
95358327fe95        dev-peer0.org1.example.com-mycc-1.0-384f11f484b9302df90b453200cfb25174305fce8f53f4e94d45ee3b6cab0ce9   <span class="s2">"chaincode -peer.addâ€¦"</span>   About a minute ago   Up About a minute                              dev-peer0.org1.example.com-mycc-1.0
a3b4300dd49b        dev-peer0.org2.example.com-mycc-1.0-15b571b3ce849066b7ec74497da3b27e54e0df1345daff3951b94245ce09c42b   <span class="s2">"chaincode -peer.addâ€¦"</span>   About a minute ago   Up About a minute                              dev-peer0.org2.example.com-mycc-1.0
c20200aa1fbb        hyperledger/fabric-tools:latest                                                                        <span class="s2">"/bin/bash"</span>              2 minutes ago        Up 2 minutes                                   cli
ea27dd462838        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        2 minutes ago        Up 2 minutes        0.0.0.0:8051-&gt;8051/tcp     peer1.org1.example.com
a9eb0c75a4ed        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        2 minutes ago        Up 2 minutes        0.0.0.0:7051-&gt;7051/tcp     peer0.org1.example.com
20f02bdc7981        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        2 minutes ago        Up 2 minutes        0.0.0.0:9051-&gt;9051/tcp     peer0.org2.example.com
6e4c68bcfdab        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        2 minutes ago        Up 2 minutes        0.0.0.0:10051-&gt;10051/tcp   peer1.org2.example.com
a67a88110615        hyperledger/fabric-orderer:latest                                                                      <span class="s2">"orderer"</span>                2 minutes ago        Up 2 minutes        0.0.0.0:7050-&gt;7050/tcp     orderer.example.com
</code></pre></div></div>

<h2 id="generate-the-org3-crypto-material">Generate the Org3 Crypto Material</h2>

<p><code class="highlighter-rouge">org3-artifacts</code> ë¼ëŠ” ì„œë¸Œ ë””ë ‰í† ë¦¬ë¡œ ë“¤ì–´ê°€ì¤ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>org3-artifacts
</code></pre></div></div>

<p>ë””ë ‰í† ë¦¬ë¡œ ë“¤ì–´ê°€ë³´ë©´ <code class="highlighter-rouge">org3-crypto.yaml</code> ê³¼ <code class="highlighter-rouge">configtx.yaml</code> ë¼ëŠ” 2ê°œì˜ yaml íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤. ì´ íŒŒì¼ì„ ì´ìš©í•˜ì—¬ ì¸ì¦ì„œ íŒŒì¼ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>../../bin/cryptogen generate <span class="nt">--config</span><span class="o">=</span>./org3-crypto.yaml
org3.example.com
</code></pre></div></div>

<p>ê·¸ëŸ¼ ì•„ë˜ì™€ ê°™ì´ <code class="highlighter-rouge">crypto-config</code> ë¼ëŠ” í´ë”ê°€ ìƒê²¨ë‚©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls
</span>configtx.yaml  crypto-config  org3-crypto.yaml
</code></pre></div></div>

<p>ì´ì œ <code class="highlighter-rouge">configtxgen</code> ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ì—¬ <code class="highlighter-rouge">Org3</code> íŠ¹ì • êµ¬ì„± ìë£Œë¥¼ JSONìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì…ë ¥í•˜ì—¬ í˜„ì¬ ë””ë ‰í† ë¦¬ì—ì„œ ìˆ˜ì§‘í•´ì•¼í•˜ëŠ” <code class="highlighter-rouge">configtx.yaml</code> íŒŒì¼ì„ ì°¾ë„ë¡ ì§€ì‹œí•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">FABRIC_CFG_PATH</span><span class="o">=</span><span class="nv">$PWD</span> <span class="o">&amp;&amp;</span> ../../bin/configtxgen <span class="nt">-printOrg</span> Org3MSP <span class="o">&gt;</span> ../channel-artifacts/org3.json
2020-01-06 11:12:53.747 UTC <span class="o">[</span>common.tools.configtxgen] main -&gt; INFO 001 Loading configuration
2020-01-06 11:12:53.748 UTC <span class="o">[</span>common.tools.configtxgen.localconfig] LoadTopLevel -&gt; INFO 002 Loaded configuration: /home/vagrant/fabric-samples/first-network/org3-artifacts/configtx.yaml
2020-01-06 11:12:53.750 UTC <span class="o">[</span>common.tools.configtxgen.encoder] NewConsortiumOrgGroup -&gt; WARN 003 Default policy emission is deprecated, please include policy specifications <span class="k">for </span>the orderer org group Org3MSP <span class="k">in </span>configtx.yaml
</code></pre></div></div>

<p>ìœ„ì˜ ëª…ë ¹ì€ JSON íŒŒì¼ (<code class="highlighter-rouge">org3.json</code>)ì„ ì‘ì„±í•˜ì—¬ ì²« ë²ˆì§¸ ë„¤íŠ¸ì›Œí¬ì˜ ë£¨íŠ¸ì—ìˆëŠ” ì±„ë„ ì•„í‹°íŒ©íŠ¸ ì„œë¸Œ ë””ë ‰í† ë¦¬ì— ì¶œë ¥í•©ë‹ˆë‹¤. ì´ íŒŒì¼ì—ëŠ” Org3ì— ëŒ€í•œ ì •ì±… ì •ì˜ì™€ ê¸°ë³¸ 64 í˜•ì‹ìœ¼ë¡œ ì œê³µë˜ëŠ” ì„¸ ê°€ì§€ ì¤‘ìš”í•œ ì¸ì¦ì„œ, ì¦‰ <code class="highlighter-rouge">admin user certificate</code> (ë‚˜ì¤‘ì— <code class="highlighter-rouge">Org3</code> ì˜ ê´€ë¦¬ìë¡œ ì‘ë™í•˜ëŠ” ë° í•„ìš”í•¨), <code class="highlighter-rouge">CA root cert</code> ë° ` TLS root cert` ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ì—ì„œëŠ”ì´ JSON íŒŒì¼ì„ ì±„ë„ êµ¬ì„±ì— ì¶”ê°€í•©ë‹ˆë‹¤.</p>

<p>ë§ˆì§€ë§‰ ì •ë¦¬ ì‘ì—…ì€ <code class="highlighter-rouge">Orderer Org</code> ì˜ <code class="highlighter-rouge">MSP</code> ìë£Œë¥¼ <code class="highlighter-rouge">Org3</code> <code class="highlighter-rouge">crypto-config</code> ë””ë ‰í† ë¦¬ë¡œ ì´ì‹í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íŠ¹íˆ, ìš°ë¦¬ëŠ” <code class="highlighter-rouge">Org3</code> ì—”í‹°í‹°ì™€ ë„¤íŠ¸ì›Œí¬ì˜ <code class="highlighter-rouge">orderering node</code> ì‚¬ì´ì˜ ì•ˆì „í•œ í†µì‹ ì„ í—ˆìš©í•˜ëŠ” Ordererì˜ TLS ë£¨íŠ¸ ì¸ì¦ì„œì— ê´€ì‹¬ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ../ <span class="o">&amp;&amp;</span> <span class="nb">cp</span> <span class="nt">-r</span> crypto-config/ordererOrganizations org3-artifacts/crypto-config/
</code></pre></div></div>

<p>ì´ì œ ì¤€ë¹„ë‹¨ê³„ëŠ” ëë‚¬ìŠµë‹ˆë‹¤.</p>

<h2 id="prepare-the-cli-environment">Prepare the CLI Environment</h2>

<p><code class="highlighter-rouge">cli</code> ì»¨í…Œì´ë„ˆë¡œ ì ‘ì†ì„ í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> cli bash
root@c20200aa1fbb:/opt/gopath/src/github.com/hyperledger/fabric/peer#
</code></pre></div></div>

<p><code class="highlighter-rouge">ORDERER_CA</code> ì™€ <code class="highlighter-rouge">CHANNEL_NAME</code> ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">ORDERER_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem  <span class="o">&amp;&amp;</span> <span class="nb">export </span><span class="nv">CHANNEL_NAME</span><span class="o">=</span>mychannel
</code></pre></div></div>

<p>ë³€ìˆ˜ê°€ ì •í™•í•˜ê²Œ ì„¤ì •ì´ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$ORDERER_CA</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$CHANNEL_NAME</span>

/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem
mychannel
</code></pre></div></div>

<h2 id="fetch-the-configuration">Fetch the Configuration</h2>

<p>ì•„ë˜ ëª…ë ¹ì€ ë°”ì´ë„ˆë¦¬ <code class="highlighter-rouge">protobuf</code> ì±„ë„ êµ¬ì„± ë¸”ë¡ì„ <code class="highlighter-rouge">config_block.pb</code> ì— ì €ì¥í•©ë‹ˆë‹¤. ì´ë¦„ê³¼ íŒŒì¼ í™•ì¥ìì˜ ì„ íƒì€ ì„ì˜ì ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í‘œì‹œë˜ëŠ” ê°ì²´ ìœ í˜•ê³¼ ì¸ì½”ë”© (protobuf ë˜ëŠ” JSON)ì„ ëª¨ë‘ ì‹ë³„í•˜ëŠ” ê·œì¹™ì„ ë”°ë¥´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>peer channel fetch config config_block.pb <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">-c</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">--tls</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span>

2020-01-06 11:20:09.140 UTC <span class="o">[</span>channelCmd] InitCmdFactory -&gt; INFO 001 Endorser and orderer connections initialized
2020-01-06 11:20:09.142 UTC <span class="o">[</span>cli.common] readBlock -&gt; INFO 002 Received block: 4
2020-01-06 11:20:09.144 UTC <span class="o">[</span>cli.common] readBlock -&gt; INFO 003 Received block: 2
2020-01-06 11:20:09.144 UTC <span class="o">[</span>channelCmd] fetch -&gt; INFO 004 Retrieving last config block: 2
</code></pre></div></div>

<p>ì´ê²ƒì€ <code class="highlighter-rouge">mychannel</code> ì— ëŒ€í•œ ê°€ì¥ ìµœì‹  êµ¬ì„± ë¸”ë¡ì´ ì‹¤ì œë¡œ ë¸”ë¡ 2ê°€ ì•„ë‹ˆë¼ ìƒì„± ë¸”ë¡ì´ë¼ëŠ” ê²ƒì„ ì•Œë ¤ì¤ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ <code class="highlighter-rouge">peer channel fetch config</code> ëª…ë ¹ì€ ëŒ€ìƒ ì±„ë„ì— ëŒ€í•œ ìµœì‹  êµ¬ì„± ë¸”ë¡ (ì´ ê²½ìš° ì„¸ ë²ˆì§¸ ë¸”ë¡)ì„ ë°˜í™˜í•©ë‹ˆë‹¤. BYFN ìŠ¤í¬ë¦½íŠ¸ê°€ ë‘ ì¡°ì§ (<code class="highlighter-rouge">Org1</code> ë° <code class="highlighter-rouge">Org2</code>)ì˜ ì•µì»¤ í”¼ì–´ë¥¼ ë‘ ê°œì˜ ê°œë³„ ì±„ë„ ì—…ë°ì´íŠ¸ íŠ¸ëœì­ì…˜ì— ì •ì˜í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>

<p>ê²°ê³¼ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„± ìˆœì„œê°€ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>block 0: genesis block</li>
  <li>block 1: Org1 anchor peer update</li>
  <li>block 2: Org2 anchor peer update</li>
</ul>

<h2 id="convert-the-configuration-to-json-and-trim-it-down">Convert the Configuration to JSON and Trim It Down</h2>

<p>ì´ì œ <code class="highlighter-rouge">configtxlator</code> ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ì´ ì±„ë„ êµ¬ì„± ë¸”ë¡ì„ JSON í˜•ì‹ (ì¸ê°„ì´ ì½ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŒ)ìœ¼ë¡œ ë””ì½”ë”©í•©ë‹ˆë‹¤. ë˜í•œ ë³€ê²½í•˜ë ¤ëŠ” ë‚´ìš©ê³¼ ê´€ë ¨ì´ì—†ëŠ” ëª¨ë“  í—¤ë”, ë©”íƒ€ ë°ì´í„°, ì œì‘ì ì„œëª… ë“±ì„ ì œê±°í•´ì•¼í•©ë‹ˆë‹¤. <code class="highlighter-rouge">jq</code> ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ì´ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>configtxlator proto_decode <span class="nt">--input</span> config_block.pb <span class="nt">--type</span> common.Block | jq .data.data[0].payload.data.config <span class="o">&gt;</span> config.json
</code></pre></div></div>

<p>ì´ë¡œ ì¸í•´ ì²« ë²ˆì§¸ ë„¤íŠ¸ì›Œí¬ ë‚´ì˜ <code class="highlighter-rouge">fabric-samples</code> í´ë”ì—ìˆëŠ” ì •ë¦¬ ëœ JSON ê°ì²´ ì¸ <code class="highlighter-rouge">config.json</code> ì´ êµ¬ì„± ì—…ë°ì´íŠ¸ì˜ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>

<h2 id="add-the-org3-crypto-material">Add the Org3 Crypto Material</h2>

<p><code class="highlighter-rouge">jq</code> ë„êµ¬ë¥¼ í•œ ë²ˆ ë” ì‚¬ìš©í•˜ì—¬ Org3 êµ¬ì„± ì •ì˜ (org3.json)ë¥¼ ì±„ë„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê·¸ë£¹ í•„ë“œì— ì¶”ê°€í•˜ê³  ì¶œë ¥ ì´ë¦„ì„ <code class="highlighter-rouge">modified_config.json</code> ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>jq <span class="nt">-s</span> <span class="s1">'.[0] * {"channel_group":{"groups":{"Application":{"groups": {"Org3MSP":.[1]}}}}}'</span> config.json ./channel-artifacts/org3.json <span class="o">&gt;</span> modified_config.json
</code></pre></div></div>

<p>ì´ì œ <code class="highlighter-rouge">CLI</code> ì»¨í…Œì´ë„ˆ ë‚´ì— <code class="highlighter-rouge">config.json</code> ê³¼ <code class="highlighter-rouge">modified_config.json</code> ì´ë¼ëŠ” ë‘ ê°œì˜ JSON íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤. ì´ˆê¸° íŒŒì¼ì—ëŠ” <code class="highlighter-rouge">Org1</code> ë° <code class="highlighter-rouge">Org2</code> ë§Œ í¬í•¨ë˜ì–´ ìˆìœ¼ë©° ìˆ˜ì • ëœ íŒŒì¼ì—ëŠ” 3 ê°œì˜ ì¡°ì§ì´ ëª¨ë‘ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì‹œì ì—ì„œ ë‘ JSON íŒŒì¼ì„ ë‹¤ì‹œ ì¸ì½”ë”©í•˜ê³  ë¸íƒ€ë¥¼ ê³„ì‚°í•˜ë©´ë©ë‹ˆë‹¤.</p>

<p>ë¨¼ì € <code class="highlighter-rouge">config.json</code> ì„ <code class="highlighter-rouge">config.pb</code> ë¼ëŠ” í”„ë¡œí†  íƒ€ì…ìœ¼ë¡œ ë‹¤ì‹œ ë³€í™˜í•˜ì‹­ì‹œì˜¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>configtxlator proto_encode <span class="nt">--input</span> config.json <span class="nt">--type</span> common.Config <span class="nt">--output</span> config.pb
</code></pre></div></div>

<p>ê·¸ëŸ° ë‹¤ìŒ <code class="highlighter-rouge">modified_config.json</code> ì„ <code class="highlighter-rouge">modified_config.pb</code> ë¡œ ì¸ì½”ë”©í•˜ì‹­ì‹œì˜¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>configtxlator proto_encode <span class="nt">--input</span> modified_config.json <span class="nt">--type</span> common.Config <span class="nt">--output</span> modified_config.pb
</code></pre></div></div>

<p>ì´ì œ <code class="highlighter-rouge">configtxlator</code> ë¥¼ ì‚¬ìš©í•˜ì—¬ì´ ë‘ êµ¬ì„± í”„ë¡œí†  íƒ€ì… ê°„ì˜ ë¸íƒ€ë¥¼ ê³„ì‚°í•˜ì‹­ì‹œì˜¤. ì´ ëª…ë ¹ì€ <code class="highlighter-rouge">org3_update.pb</code> ë¼ëŠ” ìƒˆ í”„ë¡œí†  íƒ€ì… ë°”ì´ë„ˆë¦¬ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>configtxlator compute_update <span class="nt">--channel_id</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">--original</span> config.pb <span class="nt">--updated</span> modified_config.pb <span class="nt">--output</span> org3_update.pb
</code></pre></div></div>

<p>ì´ ìƒˆë¡œìš´ í”„ë¡œí†  íƒ€ì… ì¸ <code class="highlighter-rouge">org3_update.pb</code> ì—ëŠ” Org3 ì •ì˜ì™€ Org1 ë° Org2 ì— ëŒ€í•œ ê³ ê¸‰ í¬ì¸í„°ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. Org1 ë° Org2ì— ëŒ€í•œ ê´‘ë²”ìœ„í•œ MSP ìë£Œ ë° ìˆ˜ì • ì •ì±… ì •ë³´ëŠ” ì±„ë„ì˜ ìƒì„± ë¸”ë¡ ë‚´ì— ì´ë¯¸ ì¡´ì¬í•˜ë¯€ë¡œì´ë¥¼ ë¬´ì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë‘ êµ¬ì„± ì‚¬ì´ì˜ ë¸íƒ€ ë§Œ í•„ìš”í•©ë‹ˆë‹¤.</p>

<p>ì±„ë„ ì—…ë°ì´íŠ¸ë¥¼ ì œì¶œí•˜ê¸° ì „ì— ëª‡ ê°€ì§€ ìµœì¢… ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•´ì•¼í•©ë‹ˆë‹¤. ë¨¼ì €ì´ ê°ì²´ë¥¼ í¸ì§‘ ê°€ëŠ¥í•œ JSON í˜•ì‹ìœ¼ë¡œ ë””ì½”ë”©í•˜ì—¬ <code class="highlighter-rouge">org3_update.json</code> ì´ë¼ê³ í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>configtxlator proto_decode <span class="nt">--input</span> org3_update.pb <span class="nt">--type</span> common.ConfigUpdate | jq <span class="nb">.</span> <span class="o">&gt;</span> org3_update.json
</code></pre></div></div>

<p>ì´ì œ ë´‰íˆ¬ ë©”ì‹œì§€ë¡œ ê°ì‹¸ ì•¼í•˜ëŠ” ë””ì½”ë”© ëœ ì—…ë°ì´íŠ¸ íŒŒì¼ <code class="highlighter-rouge">(org3_update.json)</code> ì´ ìˆìŠµë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ì´ì „ì— ì œê±°í–ˆë˜ í—¤ë” í•„ë“œë¥¼ ë‹¤ì‹œ ì œê³µí•©ë‹ˆë‹¤. ì´ íŒŒì¼ ì´ë¦„ì„ <code class="highlighter-rouge">org3_update_in_envelope.json</code> ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{"payload":{"header":{"channel_header":{"channel_id":"'</span><span class="nv">$CHANNEL_NAME</span><span class="s1">'", "type":2}},"data":{"config_update":'</span><span class="si">$(</span><span class="nb">cat </span>org3_update.json<span class="si">)</span><span class="s1">'}}}'</span> | jq <span class="nb">.</span> <span class="o">&gt;</span> org3_update_in_envelope.json
</code></pre></div></div>

<p>ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ëœ <code class="highlighter-rouge">JSON (org3_update_in_envelope.json)</code> ì„ ì‚¬ìš©í•˜ì—¬ ë§ˆì§€ë§‰ìœ¼ë¡œ <code class="highlighter-rouge">configtxlator</code> ë„êµ¬ë¥¼ í™œìš©í•˜ì—¬ <code class="highlighter-rouge">Fabric</code> ì— í•„ìš”í•œ ë³¸ê²©ì ì¸ í”„ë¡œí†  íƒ€ì… í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ìµœì¢… ì—…ë°ì´íŠ¸ ê°œì²´ ì´ë¦„ì„ <code class="highlighter-rouge">org3_update_in_envelope.pb</code> ë¡œ ì§€ì •í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>configtxlator proto_encode <span class="nt">--input</span> org3_update_in_envelope.json <span class="nt">--type</span> common.Envelope <span class="nt">--output</span> org3_update_in_envelope.pb
</code></pre></div></div>

<p>ì²˜ìŒ íŒŒì¼ ë””ë ‰í† ë¦¬ëŠ” ì•„ë˜ì²˜ëŸ¼ ë³€ê²½ì´ ë©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls
</span>channel-artifacts  config_block.pb  crypto  log.txt  mychannel.block scripts

<span class="nv">$ </span><span class="nb">ls
</span>channel-artifacts  config.pb        crypto   modified_config.json  mychannel.block   org3_update.pb               org3_update_in_envelope.pb
config.json        config_block.pb  log.txt  modified_config.pb    org3_update.json  org3_update_in_envelope.json  scripts
</code></pre></div></div>

<h2 id="sign-and-submit-the-config-update">Sign and Submit the Config Update</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>peer channel signconfigtx <span class="nt">-f</span> org3_update_in_envelope.pb

2020-01-06 11:22:13.217 UTC <span class="o">[</span>channelCmd] InitCmdFactory -&gt; INFO 001 Endorser and orderer connections initialized
</code></pre></div></div>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ <code class="highlighter-rouge">peer channel update</code> ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. <code class="highlighter-rouge">Org2 Admin</code> ì„œëª…ì´ í˜¸ì¶œì— ì²¨ë¶€ë˜ë¯€ë¡œ ë‘ ë²ˆì§¸ë¡œ í”„ë¡œí†  íƒ€ì…ì— ìˆ˜ë™ìœ¼ë¡œ ì„œëª… í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>peer channel update <span class="nt">-f</span> org3_update_in_envelope.pb <span class="nt">-c</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span>

2020-01-06 11:22:52.420 UTC <span class="o">[</span>channelCmd] InitCmdFactory -&gt; INFO 001 Endorser and orderer connections initialized
2020-01-06 11:22:52.440 UTC <span class="o">[</span>channelCmd] update -&gt; INFO 002 Successfully submitted channel update
</code></pre></div></div>

<h2 id="join-org3-to-the-channel">Join Org3 to the Channel</h2>

<p>ì´ ì‹œì ì—ì„œ ìƒˆë¡œìš´ ì¡°ì§ì¸ <code class="highlighter-rouge">Org3</code> ì„ í¬í•¨í•˜ë„ë¡ ì±„ë„ êµ¬ì„±ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰, ì¡°ì§ì— ì—°ê²°ëœ í”¼ì–´ê°€ ì´ì œ ë‚´ ì±„ë„ì— ì°¸ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì € <code class="highlighter-rouge">Org3</code> í”¼ì–´ ë° <code class="highlighter-rouge">Org3</code> ê´€ë ¨ CLIì— ëŒ€í•œ ì»¨í…Œì´ë„ˆë¥¼ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose <span class="nt">-f</span> docker-compose-org3.yaml up <span class="nt">-d</span>

Creating volume <span class="s2">"net_peer0.org3.example.com"</span> with default driver
Creating volume <span class="s2">"net_peer1.org3.example.com"</span> with default driver
WARNING: Found orphan containers <span class="o">(</span>cli, peer1.org1.example.com, peer0.org1.example.com, peer0.org2.example.com, peer1.org2.example.com, orderer.example.com<span class="o">)</span> <span class="k">for </span>this project. If you removed or renamed this service <span class="k">in </span>your compose file, you can run this <span class="nb">command </span>with the <span class="nt">--remove-orphans</span> flag to clean it up.
Creating peer0.org3.example.com ... <span class="k">done
</span>Creating peer1.org3.example.com ... <span class="k">done
</span>Creating Org3cli                ... <span class="k">done</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">docker ps</code> ëª…ë ¹ì–´ë¥¼ ì¹˜ë©´ ì•„ë˜ì™€ê°™ì´ ì„¤ì •ì´ ë˜ì–´ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker ps
CONTAINER ID        IMAGE                                                                                                  COMMAND                  CREATED             STATUS              PORTS                      NAMES
08a94fe84b9c        hyperledger/fabric-tools:latest                                                                        <span class="s2">"/bin/bash"</span>              3 seconds ago       Up 2 seconds                                   Org3cli
939f8ec6075f        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        4 seconds ago       Up 2 seconds        0.0.0.0:12051-&gt;12051/tcp   peer1.org3.example.com
22ad29d58ae6        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        4 seconds ago       Up 2 seconds        0.0.0.0:11051-&gt;11051/tcp   peer0.org3.example.com
39969b0b38d7        dev-peer1.org2.example.com-mycc-1.0-26c2ef32838554aac4f7ad6f100aca865e87959c9a126e86d764c8d01f8346ab   <span class="s2">"chaincode -peer.addâ€¦"</span>   17 minutes ago      Up 17 minutes                                  dev-peer1.org2.example.com-mycc-1.0
95358327fe95        dev-peer0.org1.example.com-mycc-1.0-384f11f484b9302df90b453200cfb25174305fce8f53f4e94d45ee3b6cab0ce9   <span class="s2">"chaincode -peer.addâ€¦"</span>   18 minutes ago      Up 18 minutes                                  dev-peer0.org1.example.com-mycc-1.0
a3b4300dd49b        dev-peer0.org2.example.com-mycc-1.0-15b571b3ce849066b7ec74497da3b27e54e0df1345daff3951b94245ce09c42b   <span class="s2">"chaincode -peer.addâ€¦"</span>   18 minutes ago      Up 18 minutes                                  dev-peer0.org2.example.com-mycc-1.0
c20200aa1fbb        hyperledger/fabric-tools:latest                                                                        <span class="s2">"/bin/bash"</span>              19 minutes ago      Up 19 minutes                                  cli
ea27dd462838        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        19 minutes ago      Up 19 minutes       0.0.0.0:8051-&gt;8051/tcp     peer1.org1.example.com
a9eb0c75a4ed        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        19 minutes ago      Up 19 minutes       0.0.0.0:7051-&gt;7051/tcp     peer0.org1.example.com
20f02bdc7981        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        19 minutes ago      Up 19 minutes       0.0.0.0:9051-&gt;9051/tcp     peer0.org2.example.com
6e4c68bcfdab        hyperledger/fabric-peer:latest                                                                         <span class="s2">"peer node start"</span>        19 minutes ago      Up 19 minutes       0.0.0.0:10051-&gt;10051/tcp   peer1.org2.example.com
a67a88110615        hyperledger/fabric-orderer:latest                                                                      <span class="s2">"orderer"</span>                19 minutes ago      Up 19 minutes       0.0.0.0:7050-&gt;7050/tcp     orderer.example.com
</code></pre></div></div>

<h2 id="setting-environments-variables">Setting Environments Variables</h2>

<p>ë¨¼ì € <code class="highlighter-rouge">Org3cli</code> ì»¨í…Œì´ë„ˆë¡œ ì ‘ì†ì„ í•©ë‹ˆë‹¤. ì•„ë˜ ëª…ë ¹ì–´ëŠ” 2ë²ˆ ë” ì‚¬ìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> Org3cli /bin/bash
</code></pre></div></div>

<p>ë‹¤ìŒìœ¼ë¡œ ë¨¼ì € í™˜ê²½ë³€ìˆ˜ ì„¤ì •ì„ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CHANNEL_NAME</span><span class="o">=</span>mychannel
<span class="nv">CLI_DELAY</span><span class="o">=</span>3
<span class="nv">LANGUAGE</span><span class="o">=</span>golang
<span class="nv">CLI_TIMEOUT</span><span class="o">=</span>10
<span class="nv">VERBOSE</span><span class="o">=</span><span class="nb">false
</span><span class="nv">ORDERER_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem
<span class="nv">CC_SRC_PATH</span><span class="o">=</span><span class="s2">"github.com/chaincode/chaincode_example02/go/"</span>
<span class="nv">VERSION</span><span class="o">=</span>2.0
</code></pre></div></div>

<h2 id="fetch--join-channel">Fetch &amp; Join Channel</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>peer channel fetch 0 <span class="nv">$CHANNEL_NAME</span>.block <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">-c</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">--tls</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span>

2020-01-07 13:34:36.159 UTC <span class="o">[</span>channelCmd] InitCmdFactory -&gt; INFO 001 Endorser and orderer connections initialized
2020-01-07 13:34:36.162 UTC <span class="o">[</span>cli.common] readBlock -&gt; INFO 002 Received block: 0
</code></pre></div></div>

<p><strong>peer0.org3</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG3_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org3MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG3_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org3.example.com:11051

<span class="nv">$ </span>peer channel <span class="nb">join</span> <span class="nt">-b</span> <span class="nv">$CHANNEL_NAME</span>.block

2020-01-07 13:36:36.686 UTC <span class="o">[</span>channelCmd] InitCmdFactory -&gt; INFO 001 Endorser and orderer connections initialized
2020-01-07 13:36:36.706 UTC <span class="o">[</span>channelCmd] executeJoin -&gt; INFO 002 Successfully submitted proposal to <span class="nb">join </span>channel
</code></pre></div></div>

<p><strong>peer1.org3</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer1.org3.example.com:12051

<span class="nv">$ </span>peer channel <span class="nb">join</span> <span class="nt">-b</span> <span class="nv">$CHANNEL_NAME</span>.block

2020-01-07 13:37:31.067 UTC <span class="o">[</span>channelCmd] InitCmdFactory -&gt; INFO 001 Endorser and orderer connections initialized
2020-01-07 13:37:31.088 UTC <span class="o">[</span>channelCmd] executeJoin -&gt; INFO 002 Successfully submitted proposal to <span class="nb">join </span>channel
</code></pre></div></div>

<h2 id="install-chaincode">Install Chaincode</h2>

<p><strong>peer0.org3</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org3.example.com:11051 

<span class="nv">$ </span>peer chaincode <span class="nb">install</span> <span class="nt">-n</span> mycc <span class="nt">-v</span> <span class="k">${</span><span class="nv">VERSION</span><span class="k">}</span> <span class="nt">-l</span> <span class="k">${</span><span class="nv">LANGUAGE</span><span class="k">}</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">CC_SRC_PATH</span><span class="k">}</span>

2020-01-07 13:40:35.753 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 001 Using default escc
2020-01-07 13:40:35.754 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 002 Using default vscc
2020-01-07 13:40:35.877 UTC <span class="o">[</span>chaincodeCmd] <span class="nb">install</span> -&gt; INFO 003 Installed remotely response:&lt;status:200 payload:<span class="s2">"OK"</span> <span class="o">&gt;</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ <code class="highlighter-rouge">Org3cli</code> ì»¨í…Œì´ë„ˆë¥¼ ë‚˜ê°„ ë’¤ <code class="highlighter-rouge">cli</code> ì»¨í…Œì´ë„ˆë¡œ ì ‘ì†í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> cli /bin/bash
</code></pre></div></div>

<p>ë‹¤ìŒ <strong>Setting Environments Variables</strong> ì„¤ì •í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì¤ë‹ˆë‹¤.</p>

<p><strong>peer0.org1</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG1_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org1MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG1_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org1.example.com:7051

<span class="nv">$ </span>peer chaincode <span class="nb">install</span> <span class="nt">-n</span> mycc <span class="nt">-v</span> <span class="k">${</span><span class="nv">VERSION</span><span class="k">}</span> <span class="nt">-l</span> <span class="k">${</span><span class="nv">LANGUAGE</span><span class="k">}</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">CC_SRC_PATH</span><span class="k">}</span>

2020-01-07 13:55:38.492 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 001 Using default escc
2020-01-07 13:55:38.493 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 002 Using default vscc
2020-01-07 13:55:38.609 UTC <span class="o">[</span>chaincodeCmd] <span class="nb">install</span> -&gt; INFO 003 Installed remotely response:&lt;status:200 payload:<span class="s2">"OK"</span> <span class="o">&gt;</span>
</code></pre></div></div>

<p><strong>peer0.org2</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG2_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org2MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG2_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org2.example.com:9051

<span class="nv">$ </span>peer chaincode <span class="nb">install</span> <span class="nt">-n</span> mycc <span class="nt">-v</span> <span class="k">${</span><span class="nv">VERSION</span><span class="k">}</span> <span class="nt">-l</span> <span class="k">${</span><span class="nv">LANGUAGE</span><span class="k">}</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">CC_SRC_PATH</span><span class="k">}</span>

2020-01-07 13:57:06.527 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 001 Using default escc
2020-01-07 13:57:06.528 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 002 Using default vscc
2020-01-07 13:57:06.649 UTC <span class="o">[</span>chaincodeCmd] <span class="nb">install</span> -&gt; INFO 003 Installed remotely response:&lt;status:200 payload:<span class="s2">"OK"</span> <span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="upgrade-chaincode">Upgrade Chaincode</h2>

<p><strong>peer0.org1</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG1_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org1MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG1_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org1.example.com:7051

<span class="nv">$ </span>peer chaincode upgrade <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nv">$CORE_PEER_TLS_ENABLED</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span> <span class="nt">-C</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-n</span> mycc <span class="nt">-v</span> 2.0 <span class="nt">-c</span> <span class="s1">'{"Args":["init","a","90","b","210"]}'</span> <span class="nt">-P</span> <span class="s2">"AND ('Org1MSP.peer','Org2MSP.peer','Org3MSP.peer')"</span>

2020-01-07 14:00:30.299 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 001 Using default escc
2020-01-07 14:00:30.300 UTC <span class="o">[</span>chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 002 Using default vscc
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ <code class="highlighter-rouge">cli</code> ì»¨í…Œì´ë„ˆë¥¼ ë‚˜ê°„ ë’¤ <code class="highlighter-rouge">Org3cli</code> ì»¨í…Œì´ë„ˆë¡œ ì ‘ì†í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> Org3cli /bin/bash
</code></pre></div></div>

<p>ë§ˆì°¬ê°€ì§€ë¡œ <strong>Setting Environments Variables</strong> ì„¤ì •í•œ í™˜ê²½ë³€ìˆ˜ë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì¤ë‹ˆë‹¤.</p>

<h2 id="invoke-query">Invoke, Query</h2>

<p><strong>peer0.org3 Query</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG3_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org3MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG3_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org3.example.com:11051

<span class="nv">$ </span>peer chaincode query <span class="nt">-C</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-n</span> mycc <span class="nt">-c</span> <span class="s1">'{"Args":["query","a"]}'</span>

90
</code></pre></div></div>

<p><strong>Invoke</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode invoke <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nv">$CORE_PEER_TLS_ENABLED</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span> <span class="nt">-C</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-n</span> mycc <span class="nv">$PEER_CONN_PARMS</span> <span class="nt">-c</span> <span class="s1">'{"Args":["invoke","a","b","10"]}'</span>

2020-01-07 14:09:08.245 UTC <span class="o">[</span>chaincodeCmd] chaincodeInvokeOrQuery -&gt; INFO 001 Chaincode invoke successful. result: status:200
</code></pre></div></div>

<p><strong>peer0.org3 Query</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG3_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org3MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG3_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org3.example.com:11051

<span class="nv">$ </span>peer chaincode query <span class="nt">-C</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-n</span> mycc <span class="nt">-c</span> <span class="s1">'{"Args":["query","a"]}'</span>

80
</code></pre></div></div>

<p><strong>peer0.org2 Query</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG2_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org2MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG2_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org2.example.com:9051

<span class="nv">$ </span>peer chaincode query <span class="nt">-C</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-n</span> mycc <span class="nt">-c</span> <span class="s1">'{"Args":["query","a"]}'</span>

80
</code></pre></div></div>

<p><strong>peer0.org1 Query</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PEER0_ORG1_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
<span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org1MSP"</span>
<span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span><span class="nv">$PEER0_ORG1_CA</span>
<span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
<span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org1.example.com:7051

<span class="nv">$ </span>peer chaincode query <span class="nt">-C</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-n</span> mycc <span class="nt">-c</span> <span class="s1">'{"Args":["query","a"]}'</span>

80
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ê¹Œì§€ í™•ì¸í•˜ë©´ ëë‚¬ìŠµë‹ˆë‹¤.</p>

<p>ì´ í¬ìŠ¤íŠ¸ëŠ” <code class="highlighter-rouge">./eyfn.sh generate</code> ì™€ <code class="highlighter-rouge">./eyfn.sh up</code> ê¹Œì§€ì˜ ê³¼ì •ì…ë‹ˆë‹¤. <code class="highlighter-rouge">peer</code> ë¥¼ ì¶”ê°€í•˜ê³  <code class="highlighter-rouge">chaincode</code> ë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” ë¶€ë¶„ì€ ë‹¤ë¥¸ í¬ìŠ¤íŠ¸ì—ì„œë„ í™•ì¸í•˜ê³  ë§ì´ í•´ë´¤ê¸° ë•Œë¬¸ì— ì„¤ëª…ì€ ì ê²Œí•˜ê³  <code class="highlighter-rouge">generate</code> ë¶€ë¶„ì„ ë§ì´ ì¶”ê°€í•˜ë„ë¡ ë…¸ë ¥í–ˆìŠµë‹ˆë‹¤.</p>

<p>ê°ì‚¬í•©ë‹ˆë‹¤.</p>
:ET