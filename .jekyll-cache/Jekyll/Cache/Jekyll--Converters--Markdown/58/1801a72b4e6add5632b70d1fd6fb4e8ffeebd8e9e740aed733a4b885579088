I"˜)<p><em>ì´ í¬ìŠ¤íŠ¸ëŠ” <a href="https://github.com/Avkash/mldl/blob/master/pages/docs/books/confluent-kafka-definitive-guide-complete.pdf">Kafka Definitive Guide</a>ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.</em></p>

<h2 id="os">OS</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MacOS Mojave Version 10.14.6
</code></pre></div></div>

<h2 id="installing-java">Installing Java</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew tap adoptopenjdk/openjdk
<span class="nv">$ </span>brew cask <span class="nb">install </span>adoptopenjdk8
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>java <span class="nt">-version</span>
openjdk version <span class="s2">"1.8.0_222"</span>
OpenJDK Runtime Environment <span class="o">(</span>AdoptOpenJDK<span class="o">)(</span>build 1.8.0_222-b10<span class="o">)</span>
OpenJDK 64-Bit Server VM <span class="o">(</span>AdoptOpenJDK<span class="o">)(</span>build 25.222-b10, mixed mode<span class="o">)</span>

<span class="nv">$ </span>javac <span class="nt">-versionw</span>
javac 1.8.0_222
</code></pre></div></div>

<h2 id="installing-zookeeper--kafka">Installing Zookeeper / Kafka</h2>

<p>KafkaëŠ” Zookeeperë¥¼ ì‚¬ìš©í•œë‹¤. <code class="highlighter-rouge">Example 1</code> ê³¼ ê°™ì´ ì»¨ìŠˆë¨¸ í´ë¼ì´ì–¸íŠ¸ì™€ ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„°ì— ê´€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ì„œë‹¤.</p>

<blockquote>
  <p>Example 1 - Kafka and Zookeeper</p>
</blockquote>

<p><img src="https://user-images.githubusercontent.com/44635266/70038753-21b9fb80-15fc-11ea-8612-f27dcc3fbfc2.png" alt="image" /></p>

<p>Brew ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ë©´ Kafka ì„¤ì¹˜í•  ë•Œ Zookeeper ë„ í•¨ê»˜ ì„¤ì¹˜ê°€ ëœë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew <span class="nb">install </span>kafka

<span class="o">==&gt;</span> Installing dependencies <span class="k">for </span>kafka: zookeeper
<span class="o">==&gt;</span> Installing kafka dependency: zookeeper
<span class="o">==&gt;</span> Downloading https://homebrew.bintray.com/bottles/zookeeper-3.4.12.high_sierra.bottle.tar.gz
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Pouring zookeeper-3.4.12.high_sierra.bottle.tar.gz
<span class="o">==&gt;</span> Caveats
To have launchd start zookeeper now and restart at login:
  brew services start zookeeper
Or, <span class="k">if </span>you don<span class="s1">'t want/need a background service you can just run:
  zkServer start
==&gt; Summary
ğŸº  /usr/local/Cellar/zookeeper/3.4.12: 242 files, 32.9MB
==&gt; Installing kafka
==&gt; Downloading https://homebrew.bintray.com/bottles/kafka-2.3.0.high_sierra.bottle.tar.gz
######################################################################## 100.0%
==&gt; Pouring kafka-2.3.0.high_sierra.bottle.tar.gz
==&gt; Caveats
To have launchd start kafka now and restart at login:
  brew services start kafka
Or, if you don'</span>t want/need a background service you can just run:
  zookeeper-server-start /usr/local/etc/kafka/zookeeper.properties &amp; kafka-server-start /usr/local/etc/kafka/server.properties
<span class="o">==&gt;</span> Summary
ğŸº  /usr/local/Cellar/kafka/2.3.0: 160 files, 46.8MB
<span class="o">==&gt;</span> Caveats
<span class="o">==&gt;</span> zookeeper
To have launchd start zookeeper now and restart at login:
  brew services start zookeeper
Or, <span class="k">if </span>you don<span class="s1">'t want/need a background service you can just run:
  zkServer start
==&gt; kafka
To have launchd start kafka now and restart at login:
  brew services start kafka
Or, if you don'</span>t want/need a background service you can just run:
  zookeeper-server-start /usr/local/etc/kafka/zookeeper.properties &amp; kafka-server-start /usr/local/etc/kafka/server.properties
</code></pre></div></div>

<h3 id="zookeeper-ensemble">Zookeeper Ensemble</h3>

<p>ZookeeperëŠ” Kafkaì™€ ê°™ì€ ë¶„ì‚° ì²˜ë¦¬ ì‹œìŠ¤í…œì˜ ì„œë²„ë“¤ì— ê´€í•œ ë©”íƒ€ë°ì´í„°ë“¤ì„ í†µí•© ê´€ë¦¬í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤. ì£¼í‚¤í¼ì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì•™ìƒë¸”ì´ë¼ê³  í•˜ë©°, í•˜ë‚˜ì˜ <strong>ì•™ìƒë¸”(ensemble)</strong> ì€ ì—¬ëŸ¬ê°œì˜ ì„œë²„ë¥¼ ë©¤ë²„ë¡œ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.</p>

<p>Zookeeperì— ë¬¸ì œê°€ ìƒê²¨ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ì—†ì„ë•Œ ëŒ€ê¸° ì¤‘ì¸ ì„œë²„ì¤‘ì—ì„œ ìë™ ì„ ì •í•˜ì—¬ ìƒˆë¡­ê²Œ ì„ íƒëœ ì„œë²„ê°€ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ì´ì–´ë°›ì•„ ì²˜ë¦¬í•¨ìœ¼ë¡œ ì„œë²„ê°€ ì¤‘ë‹¨ë˜ì§€ ì•Šê²Œ í•œë‹¤. ì´ë¥¼ <strong>ë¦¬ë”(Leader)</strong> ë¼ í•˜ë©°, ë‚˜ë¨¸ì§€ ëŒ€ê¸° ì„œë²„ë¥¼ <strong>íŒ”ë¡œì›Œ(Follower)</strong> ë¼ê³ í•œë‹¤.</p>

<p>Zookeeper ì„œë²„ë¥¼ ì•™ìƒë¸”ë¡œ êµ¬ì„±í• ë ¤ë©´ <code class="highlighter-rouge">zookeeper.properties</code> ë¥¼ í™•ì¸í•´ë³´ë©´ ëœë‹¤. í•´ë‹¹ íŒŒì¼ì€ <code class="highlighter-rouge">/usr/local/Cellar/kafka/2.3.0/libexec/config</code> ë””ë ‰í† ë¦¬ì— ìˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Licensed to the Apache Software Foundation (ASF) under one or more</span>
<span class="c"># contributor license agreements.  See the NOTICE file distributed with</span>
<span class="c"># this work for additional information regarding copyright ownership.</span>
<span class="c"># The ASF licenses this file to You under the Apache License, Version 2.0</span>
<span class="c"># (the "License"); you may not use this file except in compliance with</span>
<span class="c"># the License.  You may obtain a copy of the License at</span>
<span class="c">#</span>
<span class="c">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c">#</span>
<span class="c"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c"># distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="c"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c"># See the License for the specific language governing permissions and</span>
<span class="c"># limitations under the License.</span>
<span class="c"># the directory where the snapshot is stored.</span>
<span class="nv">dataDir</span><span class="o">=</span>/usr/local/var/lib/zookeeper
<span class="c"># the port at which the clients will connect</span>
<span class="nv">clientPort</span><span class="o">=</span>2181
<span class="c"># disable the per-ip l</span>

<span class="c"># --------------------------------------------------------</span>

<span class="c"># dataDir=/var/lib/zookeeper</span>
<span class="c"># initTime=20</span>
<span class="c"># tickTime=2000</span>
<span class="c"># syncLimit=5</span>
<span class="c"># server.1=zookeeper1.example.com:2888:3888</span>
<span class="c"># server.2=zookeeper2.example.com:2888:3888</span>
<span class="c"># server.3=zookeeper3.example.com:2888:3888</span>
</code></pre></div></div>

<p>ì¤‘ê°„ì— êµ¬ë¶„ì„ ì„ ì•„ë˜ì— ìˆëŠ” ë‚´ìš©ì€ ì œê°€ ì„ì˜ë¡œ ì‘ì„±í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>

<p><strong>initTime</strong></p>

<p>íŒ”ë¡œì›Œê°€ ë¦¬ë”ì— ì ‘ì†í•  ìˆ˜ ìˆëŠ” ì‹œê°„ì´ë‹¤. ì´ëŠ” ticktimeì˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì •í•œë‹¤. 20 * 2000 ms ì¦‰ 40ì´ˆê°€ëœë‹¤.</p>

<p><strong>syncLimit</strong></p>

<p>ë¦¬ë”ê°€ ë  ìˆ˜ ìˆëŠ” íŒ”ë¡œì›Œë“¤ì˜ ìµœëŒ€ ê°œìˆ˜ë‹¤.</p>

<p><strong>server.1</strong></p>

<p>ì•™ìƒë¸”ì„ í•  ë•Œ ì—®ì„ Zookeeperì˜ ì„œë²„ë‹¤.</p>

<h3 id="start-kafka">Start Kafka</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>zookeeper-server-start /usr/local/Cellar/kafka/2.3.0/libexec/config/zookeeper.properties

<span class="nv">$ $ </span>kafka-server-start /usr/local/Cellar/kafka/2.3.0/libexec/config/server.properties
</code></pre></div></div>

<p>ì„œë²„ë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ë¡œê·¸ê°€ ì—„ì²­ ê¹ë‹ˆë‹¤. ë¡œê·¸ë¥¼ í™•ì¸í•´ë³´ê³  ì‹¶ìœ¼ì‹ ë¶„ì€ <a href="/kafka-logs">ì—¬ê¸°</a>ë¥¼ í´ë¦­í•´ ì£¼ì„¸ìš”. <em>ìƒë‹¹íˆ ê¹ë‹ˆë‹¤</em></p>

<p><strong>Create Topic 1 Partitions</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kafka-topics <span class="nt">--create</span> <span class="nt">--zookeeper</span> localhost:2181 <span class="nt">--replication-factor</span> 1 <span class="nt">--partitions</span> 1 <span class="nt">--topic</span> firstMytopic
Created topic firstMytopic.
</code></pre></div></div>

<p><strong>Topic List</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kafka-topics <span class="nt">--list</span> <span class="nt">--zookeeper</span> localhost:2181
firstMytopic
</code></pre></div></div>

<p><strong>Publish Message (Producer)</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kafka-console-producer <span class="nt">--broker-list</span> localhost:9092 <span class="nt">--topic</span> firstMytopic
</code></pre></div></div>

<p><strong>Subscribe Message (Consumer)</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kafka-console-consumer â€”bootstrap-server localhost:9092 â€”topic firstMytopic â€”from-beginning
</code></pre></div></div>

<p>ì•„ë˜ ì‚¬ì§„ì„ ë´¤ì„ë•Œ ì™¼ìª½ì´ <code class="highlighter-rouge">Producer</code> ì˜¤ë¥¸ìª½ì´ <code class="highlighter-rouge">Consumer</code> ì…ë‹ˆë‹¤. Producerì—ì„œ ë©”ì„¸ì§€ë¥¼ ì¹˜ë©´ Consumerì—ì„œ ë°›ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><img width="1208" alt="ìŠ¤í¬ë¦°ìƒ· 2019-10-05 ì˜¤í›„ 8 16 35" src="https://user-images.githubusercontent.com/44635266/66254141-438a3400-e7ad-11e9-833e-661e7ac826fd.png" /></p>

<p><strong>Stop Kafka Server</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kafka-server-stop
</code></pre></div></div>

<p><strong>Stop Zookeeper Server</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>zookeeper-srver-stop
</code></pre></div></div>

<p>Kafka ì—ì„œë„ <code class="highlighter-rouge">server.properties</code> ë¥¼ í™•ì¸í•´ë³´ë©´ ë°˜ë“œì‹œ ê²€í† í•´ì•¼í•˜ëŠ” ë¸Œë¡œì»¤ êµ¬ì„± ë§¤ê°œë³€ìˆ˜ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‚´ìš©ì´ ê¸¸ì–´ì§ˆêº¼ ê°™ìœ¼ë‹ˆ ë‹¤ìŒ í¬ìŠ¤íŠ¸ì— ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.</p>
:ET