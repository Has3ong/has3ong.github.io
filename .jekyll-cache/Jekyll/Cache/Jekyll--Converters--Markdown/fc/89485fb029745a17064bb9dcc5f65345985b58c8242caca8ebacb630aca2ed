I"6<p><em>ì´ í¬ìŠ¤íŠ¸ëŠ” <a href="https://github.com/ethereumbook/ethereumbook">Mastering Ethereum</a>ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.</em></p>

<h3 id="launching-our-own-erc20-token">Launching Our Own ERC20 Token</h3>

<p>íŠ¸ëŸ¬í”Œ í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•˜ì—¬ ìì²´ í† í°ì„ ë§Œë“¤ê³  ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p><em>Mastering Ethereum Token</em> í† í°ì„ <em>MET</em> ë¼ê³  ë¶€ë¥´ê² ìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>ì˜ˆì œëŠ” <a href="https://github.com/ethereumbook/ethereumbook/tree/develop/code/truffle/METoken">Github</a> ì €ì¥ì†Œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>

<p>ìš°ì„ , íŠ¸ëŸ¬í”Œ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ê³  ì´ˆê¸°í™”í•©ë‹ˆë‹¤. 4ê°œì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  ëª¨ë“  ì§ˆë¬¸ì— ëŒ€í•´ ê¸°ë³¸ ì„¤ì •ë˜ì–´ ìˆëŠ” ë‹µì„ í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>METoken
<span class="nv">$ </span><span class="nb">cd </span>METoken
METoken <span class="nv">$ </span>truffle init
METoken <span class="nv">$ </span>npm init
</code></pre></div></div>

<p>í•˜ê²Œë˜ë©´ ì•„ë˜ì™€ê°™ì€ ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ ê°€ì§€ê²Œë©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>METoken/
+---- contracts
|   <span class="sb">`</span><span class="nt">----</span> Migrations.sol
+---- migrations
|   <span class="sb">`</span><span class="nt">----</span> 1_initial_migration.js
+---- package.json
+---- <span class="nb">test</span>
+---- truffle-config.js
<span class="sb">`</span><span class="nt">----</span> truffle.js
</code></pre></div></div>

<p><code class="highlighter-rouge">truffle.js</code> ì™€ <code class="highlighter-rouge">truffle-config.js</code> ì„¤ì •íŒŒì¼ì„ í¸ì§‘í•˜ì—¬ íŠ¸ëŸ¬í”Œ í™˜ê²½ì„ ì„¤ì •í•˜ê±°ë‚˜, í™˜ê²½ì„¤ì • íŒŒì¼ì„ <a href="https://github.com/ethereumbook/ethereumbook/blob/develop/code/truffle/METoken/truffle-config.js">Github</a> ì—ì„œ ë³µì‚¬í•˜ë©´ë©ë‹ˆë‹¤.</p>

<p>ê·¸ í›„ì— ë””ë ‰í† ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì„ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>METoken/
+---- contracts
|   <span class="sb">`</span><span class="nt">----</span> Migrations.sol
+---- migrations
|   <span class="sb">`</span><span class="nt">----</span> 1_initial_migration.js
+---- package.json
+---- <span class="nb">test</span>
+---- truffle-config.js
+---- truffle.js
<span class="sb">`</span><span class="nt">----</span> .env <span class="k">*</span>new file<span class="k">*</span>
</code></pre></div></div>

<p>ìœ„ ì˜ˆì œì—ì„œ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ë³´ì•ˆ ê²€ì‚¬ë¥¼ êµ¬í˜„í•˜ê³  í™•ì¥í•˜ê¸° ì‰¬ìš´ ì˜¤í”ˆì œí”Œë¦° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm <span class="nb">install </span>openzeppelin-solidity@1.12.0

+ openzeppelin-solidity@1.12.0
added 1 package from 1 contributor and audited 2381 packages <span class="k">in </span>4.074s
</code></pre></div></div>

<p><code class="highlighter-rouge">openzeppelin-solidity</code> íŒ¨í‚¤ì§€ëŠ” <code class="highlighter-rouge">node_modules</code> ì•„ë˜ ì•½ 250 ê°œì˜ íŒŒì¼ì„ ì¶”ê°€í• ê²ƒì´ê³ , ì˜¤í”ˆì œí”Œë¦° ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ëŠ” ERC20 í† í° ì´ìƒì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë‚˜, ì¼ë¶€ë§Œ ì‚¬ìš©í• ê²ƒì…ë‹ˆë‹¤.</p>

<p>ë‹¤ìŒìœ¼ë¡œ í† í° ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. ìƒˆíŒŒì¼ <code class="highlighter-rouge">METoken.sol</code> ì„ ì‘ì„±í•˜ê³  <a href="">Github</a> ì— ì˜ˆì œ ì½”ë“œë¥¼ ë³µì‚¬í•©ë‹ˆë‹¤.</p>

<blockquote>
  <p>Example - METoken.sol: A Solidity contract implementing an ERC20 token</p>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">21</span><span class="o">;</span>

<span class="kn">import</span> <span class="err">'</span><span class="nn">openzeppelin</span><span class="o">-</span><span class="n">solidity</span><span class="o">/</span><span class="n">contracts</span><span class="o">/</span><span class="n">token</span><span class="o">/</span><span class="no">ERC20</span><span class="o">/</span><span class="nc">StandardToken</span><span class="o">.</span><span class="na">sol</span><span class="err">'</span><span class="o">;</span>

<span class="n">contract</span> <span class="nc">METoken</span> <span class="n">is</span> <span class="nc">StandardToken</span> <span class="o">{</span>
    <span class="n">string</span> <span class="kd">public</span> <span class="n">constant</span> <span class="n">name</span> <span class="o">=</span> <span class="err">'</span><span class="nc">Mastering</span> <span class="nc">Ethereum</span> <span class="nc">Token</span><span class="err">'</span><span class="o">;</span>
    <span class="n">string</span> <span class="kd">public</span> <span class="n">constant</span> <span class="n">symbol</span> <span class="o">=</span> <span class="err">'</span><span class="no">MET</span><span class="err">'</span><span class="o">;</span>
    <span class="n">uint8</span> <span class="kd">public</span> <span class="n">constant</span> <span class="n">decimals</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="n">uint</span> <span class="n">constant</span> <span class="n">_initial_supply</span> <span class="o">=</span> <span class="mi">2100000000</span><span class="o">;</span>

    <span class="n">function</span> <span class="nf">METoken</span><span class="o">()</span> <span class="kd">public</span> <span class="o">{</span>
        <span class="n">totalSupply_</span> <span class="o">=</span> <span class="n">_initial_supply</span><span class="o">;</span>
        <span class="n">balances</span><span class="o">[</span><span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">]</span> <span class="o">=</span> <span class="n">_initial_supply</span><span class="o">;</span>
        <span class="n">emit</span> <span class="nf">Transfer</span><span class="o">(</span><span class="n">address</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">,</span> <span class="n">_initial_supply</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œëŠ” ìƒìˆ˜ ë³€ìˆ˜ì¸ <code class="highlighter-rouge">name</code>, <code class="highlighter-rouge">symbol</code>, <code class="highlighter-rouge">decimals</code> ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. 2100 ë§Œ ê°œì˜ í† í°ìœ¼ë¡œ ì„¤ì •ëœ <code class="highlighter-rouge">_initial_supply</code> ë³€ìˆ˜ë„ ì •ì˜í•©ë‹ˆë‹¤. ì„¸ë¶„í™”ëœ 2 ê°œì˜ ì‹­ì§„ìˆ˜ëŠ” ì´ 21 ì–µ ê°œì˜ ë‹¨ìœ„ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì»¨íŠ¸ë™íŠ¸ì˜ ì´ˆê¸°í™” í•¨ìˆ˜ì—ì„œ <code class="highlighter-rouge">totalSupply</code> ë¥¼ <code class="highlighter-rouge">_initial_supply</code> ì™€ ê°™ê²Œ ì„¤ì •í•˜ê³  ëª¨ë‘ í• ë‹¹í•©ë‹ˆë‹¤. <code class="highlighter-rouge">_initial_supply</code> ë¥¼ <code class="highlighter-rouge">METoken</code> ì»¨íŠ¸ë™íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ê³„ì •ì˜ ì”ì•¡ì— ì¶”ê°€í•©ë‹ˆë‹¤.</p>

<p>ì´ì œ <strong>truffle</strong> ì„ ì‚¬ìš©í•˜ì—¬ METoken ì½”ë“œë¥¼ ì»´íŒŒì¼í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>truffle compile
Compiling ./contracts/METoken.sol...
Compiling ./contracts/Migrations.sol...
Compiling openzeppelin-solidity/contracts/math/SafeMath.sol...
Compiling openzeppelin-solidity/contracts/token/ERC20/BasicToken.sol...
Compiling openzeppelin-solidity/contracts/token/ERC20/ERC20.sol...
Compiling openzeppelin-solidity/contracts/token/ERC20/ERC20Basic.sol...
Compiling openzeppelin-solidity/contracts/token/ERC20/StandardToken.sol...
</code></pre></div></div>

<p><strong>truffle</strong> ì€ ë³´ë‹¤ì‹œí”¼ ì˜¤í”ˆì œí”Œë¦° ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í•„ìš”í•œ <strong>dependencies</strong> ë¥¼ í¬í•¨í•˜ê³  í•´ë‹¹ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì»´íŒŒì¼í•©ë‹ˆë‹¤.</p>

<p><code class="highlighter-rouge">METoken</code> ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•˜ê¸° ìœ„í•´ <strong>migrate</strong> ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì„¤ì •í•˜ê² ìŠµë‹ˆë‹¤. <code class="highlighter-rouge">METoken/migrations</code> í´ë”ì— <code class="highlighter-rouge">2_deploy_contracts.js</code> ë¼ëŠ” ìƒˆ íŒŒì¼ì„ ë§Œë“¤ê³  <a href="">Github</a> ì— ìˆëŠ” ì˜ˆì œì˜ ë‚´ìš©ì„ ë³µì‚¬í•©ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="nc">METoken</span> <span class="o">=</span> <span class="n">artifacts</span><span class="o">.</span><span class="na">require</span><span class="o">(</span><span class="s">"METoken"</span><span class="o">);</span>

<span class="n">module</span><span class="o">.</span><span class="na">exports</span> <span class="o">=</span> <span class="n">function</span><span class="o">(</span><span class="n">deployer</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Deploy the METoken contract as our only task</span>
  <span class="n">deployer</span><span class="o">.</span><span class="na">deploy</span><span class="o">(</span><span class="nc">METoken</span><span class="o">);</span>
<span class="o">};</span>
</code></pre></div></div>

<p>ì´ë”ë¦¬ì›€ í…ŒìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ì¤‘ í•˜ë‚˜ì— ë°°í¬í•˜ê¸° ì „ì— ë¡œì»¬ ë¸”ë¡ì²´ì¸ì„ ì‹œì‘í•˜ì—¬ ëª¨ë“ ê²ƒì„ í…ŒìŠ¤íŠ¸ í•©ë‹ˆë‹¤. <code class="highlighter-rouge">ganache-cli</code> ì»¤ë§¨ë“œ ë¼ì¸ ë˜ëŠ” GUI ì—ì„œ ganache ë¸”ë¡ì²´ì¸ì„ ì‹œì‘í•©ë‹ˆë‹¤.</p>

<p>ganache ê°€ ì‹œì‘ë˜ë©´ METoken ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•˜ê³  ëª¨ë“  ê²ƒì´ ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>truffle migrate <span class="nt">--network</span> ganache
Using network <span class="s1">'ganache'</span><span class="nb">.</span>

Running migration: 1_initial_migration.js
  Deploying Migrations...
  ... 0xb2e90a056dc6ad8e654683921fc613c796a03b89df6760ec1db1084ea4a084eb
  Migrations: 0x8cdaf0cd259887258bc13a92c0a6da92698644c0
Saving successful migration to network...
  ... 0xd7bc86d31bee32fa3988f1c1eabce403a1b5d570340a3a9cdba53a472ee8c956
Saving artifacts...
Running migration: 2_deploy_contracts.js
  Deploying METoken...
  ... 0xbe9290d59678b412e60ed6aefedb17364f4ad2977cfb2076b9b8ad415c5dc9f0
  METoken: 0x345ca3e014aaf5dca488057592ee47305d9b3e10
Saving successful migration to network...
  ... 0xf36163615f41ef7ed8f4a8f192149a0bf633fe1a2398ce001bf44c43dc7bdda0
Saving artifacts...
</code></pre></div></div>

<p>ganache ì½˜ì†”ì—ì„œ <code class="highlighter-rouge">Example 1</code> ê³¼ ê°™ì´ ë°°í¬ë¥¼ í†µí•´ 4 ê°€ì§€ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì´ ìƒì„±ëœ ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>Example 1 - METoken deployment on ganache</p>
</blockquote>

<p><img src="https://user-images.githubusercontent.com/44635266/73257609-6e3e4380-4207-11ea-81f5-0eb41832da6d.png" alt="image" /></p>

<h3 id="interacting-with-metoken-using-the-truffle-console">Interacting with METoken using the Truffle console</h3>

<p>íŠ¸ëŸ¬í”Œ ì½˜ì†”ì„ ì‚¬ìš©í•˜ì—¬ ganache ë¸”ë¡ì²´ì¸ìƒì— ìˆëŠ” ìš°ë¦¬ì˜ ì»¨íŠ¸ë™íŠ¸ì™€ ìƒí˜¸ì‘ìš©ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì½˜ì†”ì€ íŠ¸ëŸ¬í”Œ í™˜ê²½ê³¼ web3 ë¥¼ í†µí•´ ë¸”ë¡ì²´ì¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì–‘ë°©í–¥ ìë°”ìŠ¤í¬ë¦½íŠ¸ í™˜ê²½ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” íŠ¸ëŸ¬í”Œ ì½˜ì†”ì„ ganache ë¸”ë¡ì²´ì¸ì— ì—°ê²°í•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>truffle console <span class="nt">--network</span> ganache
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">truffle(ganache)&gt;</code> í”„ë¡¬í”„íŠ¸ëŠ” ìš°ë¦¬ê°€ ganache ë¸”ë¡ì²´ì¸ì— ì—°ê²°ë˜ì–´ ìˆìœ¼ë©° ëª…ë ¹ì„ ì…ë ¥í•  ì¤€ë¹„ê°€ ë˜ì–´ìˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. íŠ¸ëŸ¬í”Œ ì½˜ì†”ì€ ëª¨ë“  truffle ëª…ë ¹ì„ ì§€ì›í•˜ë¯€ë¡œ ì½˜ì†”ì—ì„œ compile ê³¼ migrate ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code class="highlighter-rouge">METoken</code> ì»¨íŠ¸ë™íŠ¸ëŠ” íŠ¸ëŸ¬í”Œ í™˜ê²½ì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°ì²´ë¡œ ì¡´ì¬í•©ë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ì—ì„œ <code class="highlighter-rouge">METoken</code> ì„ ì…ë ¥í•˜ë©´ ì „ì²´ ì»¨íŠ¸ë™íŠ¸ ì •ì˜ê°€ ë¤í”„ë ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken
<span class="o">{</span> <span class="o">[</span>Function: TruffleContract]
  _static_methods:

<span class="o">[</span>...]

currentProvider:
 HttpProvider <span class="o">{</span>
   host: <span class="s1">'http://localhost:7545'</span>,
   <span class="nb">timeout</span>: 0,
   user: undefined,
   password: undefined,
   headers: undefined,
   send: <span class="o">[</span>Function],
   sendAsync: <span class="o">[</span>Function],
   _alreadyWrapped: <span class="nb">true</span> <span class="o">}</span>,
network_id: <span class="s1">'5777'</span> <span class="o">}</span>
</code></pre></div></div>

<p>ë˜í•œ, <code class="highlighter-rouge">METoken</code> ì˜ ê°ì²´ëŠ” ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œì™€ ê°™ì€ ì—¬ëŸ¬ ì†ì„±ì„ í‘œì‹œí•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.address
<span class="s1">'0x345ca3e014aaf5dca488057592ee47305d9b3e10'</span>
</code></pre></div></div>

<p>ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ì™€ ìƒí˜¸ì‘ìš©í•˜ë ¤ëŠ” ê²½ìš° ìë°”ìŠ¤í¬ë¦½íŠ¸ promise í˜•ì‹ìœ¼ë¡œ ë¹„ë™ê¸° í˜¸ì¶œì„ í•´ì•¼í•©ë‹ˆë‹¤. <code class="highlighter-rouge">deployed</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨íŠ¸ë™íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì ¸ì˜¨ í›„ì— <code class="highlighter-rouge">totalSupply</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span> instance.totalSupply<span class="o">())</span>
BigNumber <span class="o">{</span> s: 1, e: 9, c: <span class="o">[</span> 2100000000 <span class="o">]</span> <span class="o">}</span>
</code></pre></div></div>

<p>ë‹¤ìŒìœ¼ë¡œ ganache ê°€ ë§Œë“  ê³„ì •ì„ ì‚¬ìš©í•˜ì—¬ <code class="highlighter-rouge">METoken</code> ì”ì•¡ì„ í™•ì¸í•˜ê³  <code class="highlighter-rouge">METoken</code> ì„ ë‹¤ë¥¸ ì£¼ì†Œë¡œ ë³´ëƒ…ë‹ˆë‹¤. ë¨¼ì € ê³„ì • ì£¼ì†Œë¥¼ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> <span class="nb">let </span>accounts
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> web3.eth.getAccounts<span class="o">((</span>err,res<span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span> accounts <span class="o">=</span> res <span class="o">})</span>
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> accounts[0]
<span class="s1">'0x627306090abab3a6e1400e9345bc60c78a8bef57'</span>
</code></pre></div></div>

<p>accounts ë¦¬ìŠ¤íŠ¸ì—ëŠ” ì´ì œ ganache ê°€ ë§Œë“  ëª¨ë“  ê³„ì •ì´ í¬í•¨ë˜ë©°, <code class="highlighter-rouge">account[0]</code> ì€ <code class="highlighter-rouge">METoken</code> ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•œ ê³„ì •ì…ë‹ˆë‹¤. <code class="highlighter-rouge">METoken</code> ìƒì„±ìëŠ” ìƒì„±ëœ ì£¼ì†Œì— ì „ì²´ í† í°ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì— <code class="highlighter-rouge">METoken</code> ì”ì•¡ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤. í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.balanceOf<span class="o">(</span>accounts[0]<span class="o">)</span>.then<span class="o">(</span>console.log<span class="o">)</span> <span class="o">})</span>
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> BigNumber <span class="o">{</span> s: 1, e: 9, c: <span class="o">[</span> 2100000000 <span class="o">]</span> <span class="o">}</span>
</code></pre></div></div>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, ì»¨íŠ¸ë™íŠ¸ì˜ <code class="highlighter-rouge">transfer</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ <code class="highlighter-rouge">account[0]</code> ì—ì„œ <code class="highlighter-rouge">account[1]</code> ë¡œ 1000.00 <code class="highlighter-rouge">METoken</code> ì„ ì „ì†¡í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.transfer<span class="o">(</span>accounts[1], 100000<span class="o">)</span> <span class="o">})</span>
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.balanceOf<span class="o">(</span>accounts[0]<span class="o">)</span>.then<span class="o">(</span>console.log<span class="o">)</span> <span class="o">})</span>
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> BigNumber <span class="o">{</span> s: 1, e: 9, c: <span class="o">[</span> 2099900000 <span class="o">]</span> <span class="o">}</span>
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.balanceOf<span class="o">(</span>accounts[1]<span class="o">)</span>.then<span class="o">(</span>console.log<span class="o">)</span> <span class="o">})</span>
undefined
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> BigNumber <span class="o">{</span> s: 1, e: 5, c: <span class="o">[</span> 100000 <span class="o">]</span> <span class="o">}</span>
</code></pre></div></div>

<p>í™•ì¸í•˜ë©´ ê³„ì •ì˜ ì”ì•¡ì´ ë°”ë€ê±¸ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>Example 3 - METoken transfer on ganache</p>
</blockquote>

<p><img src="https://user-images.githubusercontent.com/44635266/73258408-f709af00-4208-11ea-9a5a-fa216ae8a311.png" alt="image" /></p>

<h3 id="sending-erc20-tokens-to-contract-addresses">Sending ERC20 tokens to contract addresses</h3>

<p>ì§€ê¸ˆê¹Œì§€ ERC20 í† í°ì„ ì„¤ì •í•˜ê³  í•˜ë‚˜ì˜ ê³„ì •ì—ì„œ ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ í† í°ì„ ì „ì†¡í–ˆìŠµë‹ˆë‹¤. ë°ëª¨ì— ì‚¬ìš©í•œ ëª¨ë“  ê³„ì •ì€ EOA ìœ¼ë¡œ ì»¨íŠ¸ë™íŠ¸ê°€ ì•„ë‹Œ ê°œì¸í‚¤ë¡œ ì œì–´ê°€ ë©ë‹ˆë‹¤. MET ë¥¼ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œë¡œ ë³´ë‚´ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì € í…ŒìŠ¤íŠ¸ í™˜ê²½ì— ë˜ ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p>ì•„ë˜ ë””ë ‰í† ë¦¬ì™€ ê°™ì´ <code class="highlighter-rouge">METoken</code> í”„ë¡œì íŠ¸ì— ì¶”ê°€í•´ì„œ ë§Œë“¤ë©´ë©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>METoken/
+---- contracts
|   +---- Faucet.sol
|   +---- METoken.sol
|   <span class="sb">`</span><span class="nt">----</span> Migrations.sol
</code></pre></div></div>

<p><code class="highlighter-rouge">METoken</code> ê³¼ëŠ” ë³„ë„ë¡œ <code class="highlighter-rouge">Faucet</code> ì„ ë°°í¬í•˜ê¸° ìœ„í•´ migration ì„ ì¶”ê°€ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var Faucet <span class="o">=</span> artifacts.require<span class="o">(</span><span class="s2">"Faucet"</span><span class="o">)</span><span class="p">;</span>

module.exports <span class="o">=</span> <span class="k">function</span><span class="o">(</span>deployer<span class="o">)</span> <span class="o">{</span>
  // Deploy the Faucet contract as our only task
  deployer.deploy<span class="o">(</span>Faucet<span class="o">)</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</code></pre></div></div>

<p>íŠ¸ëŸ¬í”Œ ì½˜ì†”ì—ì„œ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì»´íŒŒì¼í•˜ê³  migration í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>truffle console <span class="nt">--network</span> ganache
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> compile
Compiling ./contracts/Faucet.sol...
Writing artifacts to ./build/contracts

truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> migrate
Using network <span class="s1">'ganache'</span><span class="nb">.</span>

Running migration: 1_initial_migration.js
  Deploying Migrations...
  ... 0x89f6a7bd2a596829c60a483ec99665c7af71e68c77a417fab503c394fcd7a0c9
  Migrations: 0xa1ccce36fb823810e729dce293b75f40fb6ea9c9
Saving artifacts...
Running migration: 2_deploy_contracts.js
  Replacing METoken...
  ... 0x28d0da26f48765f67e133e99dd275fac6a25fdfec6594060fd1a0e09a99b44ba
  METoken: 0x7d6bf9d5914d37bcba9d46df7107e71c59f3791f
Saving artifacts...
Running migration: 3_deploy_faucet.js
  Deploying Faucet...
  ... 0x6fbf283bcc97d7c52d92fd91f6ac02d565f5fded483a6a0f824f66edc6fa90c3
  Faucet: 0xb18a42e9468f7f1342fa3c329ec339f254bc7524
Saving artifacts...
</code></pre></div></div>

<p>ì´ì œ <code class="highlighter-rouge">Faucet</code> ì»¨íŠ¸ë™íŠ¸ ì¼ë¶€ MET ë¥¼ ë³´ë‚´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.transfer<span class="o">(</span>Faucet.address, 100000<span class="o">)</span> <span class="o">})</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.balanceOf<span class="o">(</span>Faucet.address<span class="o">)</span>.then<span class="o">(</span>console.log<span class="o">)})</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> BigNumber <span class="o">{</span> s: 1, e: 5, c: <span class="o">[</span> 100000 <span class="o">]</span> <span class="o">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">Faucet</code> ì»¨íŠ¸ë™íŠ¸ì— 1,000 MET ë¥¼ ì†¡ê¸ˆí–ˆìŠµë‹ˆë‹¤. ì´ì œ ì–´ë–»ê²Œ ì¶œê¸ˆí•˜ëŠ”ì§€ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p><code class="highlighter-rouge">Faucet.sol</code> ì€ ë‹¨ìˆœí•œ ì»¨íŠ¸ë™íŠ¸ ì…ë‹ˆë‹¤. <strong>ì´ë”</strong> ë¥¼ ì¶œê¸ˆí•˜ê¸° ìœ„í•œ <code class="highlighter-rouge">withdraw</code> í•¨ìˆ˜ í•˜ë‚˜ë§Œ ìˆìœ¼ë©´ ë©ë‹ˆë‹¤. MET ë˜ëŠ” ERC20 í† í°ì„ ì¶œê·¼í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. <code class="highlighter-rouge">withdraw</code> ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ë”ë¥¼ ë³´ë‚´ë ¤ê³  ì‹œë„í•˜ì§€ë§Œ, Faucet ì´ ì•„ì§ ì´ë” ì”ì•¡ì´ ì—†ìœ¼ë¯€ë¡œ ì‹¤íŒ¨í•©ë‹ˆë‹¤.</p>

<p><code class="highlighter-rouge">METoken</code> ì»¨íŠ¸ë™íŠ¸ëŠ” <code class="highlighter-rouge">Faucet</code> ì”ì•¡ì´ ìˆìŒì„ ì•Œì§€ë§Œ, ì»¨íŠ¸ë™íŠ¸ ì”ì•¡ì„ ì´ì²´í•  ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë°©ë²•ì€ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œì—ì„œ <code class="highlighter-rouge">transfer</code> í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ì–´ë–»ê²Œë“  <code class="highlighter-rouge">Faucet</code> ì»¨íŠ¸ë™íŠ¸ê°€ <code class="highlighter-rouge">METoken</code> ì˜ <code class="highlighter-rouge">transfer</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>ERC20 í† í° ì‚¬ìš©ìê°€ ì‹¤ìˆ˜ë¡œ êµí™˜ì—ì„œ í† í°ì„ ìƒì–´ë²„ë¦¬ëŠ” ê²½ìš° ì¤‘ í•˜ë‚˜ëŠ” ê±°ë˜ì†Œë‚˜ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ë¡œ ì „ì†¡í•˜ë ¤ê³  í•  ë•Œì…ë‹ˆë‹¤. ê±°ë˜ì†Œì˜ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì´ë”ë¦¬ì›€ ì£¼ì†Œë¥¼ ë³µì‚¬í•˜ì—¬ ë‹¨ìˆœíˆ í† í°ì„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•˜ì§€ë§Œ, ë§ì€ ê±°ë˜ì†ŒëŠ” ì‹¤ì œ ìˆ˜ì‹  ì£¼ì†Œê°€ ì»¨íŠ¸ë™íŠ¸ì¸ ì£¼ì†Œë¥¼ ê²Œì‹œí•©ë‹ˆë‹¤. ì´ ì»¨íŠ¸ë™íŠ¸ëŠ” ERC20 í† í°ì´ ì•„ë‹Œ ì´ë”ë¥¼ ë°›ê¸° ìœ„í•œ ìš©ë„ë¡œ ì‚¬ìš©ë˜ë©°, ëŒ€ë¶€ë¶„ <strong>cold storage</strong> ì´ê±°ë‚˜ ë‹¤ë¥¸ ì¤‘ì•™ ì§‘ì¤‘ì‹ ì§€ê°‘ìœ¼ë¡œ ì†¡ê¸ˆëœ ëª¨ë“  ìê¸ˆìœ¼ë¡œ ì˜®ê¹ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ìš°ë¡œ ë§ì€ í† í°ì´ ë¶„ì‹¤ë©ë‹ˆë‹¤.</p>

<h3 id="demonstrating-the-approve--transferfrom-workflow">Demonstrating the â€œapprove &amp; transferFromâ€ workflow</h3>

<p><code class="highlighter-rouge">Faucet</code> ì»¨íŠ¸ë™íŠ¸ëŠ” ERC20 í† í°ì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. <code class="highlighter-rouge">transfer</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í† í°ì„ ë³´ë‚´ë©´ í† í°ì˜ ì†ì‹¤ë©ë‹ˆë‹¤. ì´ì œ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë‹¤ì‹œ ì‘ì„±í•˜ê³  ERC20 í† í°ì„ ì²˜ë¦¬í•˜ë„ë¡ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p>ì´ ì˜ˆì œëŠ” truffle ê³¼ npm ì„ ì´ˆê¸°í™”í•˜ê³  í”„ë¡œì íŠ¸ ë””ë ‰í„°ë¦¬ì˜ ì‚¬ë³¸ì„ ë§Œë“¤ë©°, ì˜¤í”ˆì œí”Œë¦° ë””íœë˜ì‹œë“¤ì„ ì„¤ì¹˜í•œ ë‹¤ìŒ, <code class="highlighter-rouge">METoken.sol</code> ì»¨íŠ¸ë™íŠ¸ë¥¼ ë³µì‚¬í•˜ê² ìŠµë‹ˆë‹¤.</p>

<p>ìƒˆë¡œìš´ <code class="highlighter-rouge">Faucet</code> ì»¨íŠ¸ë™íŠ¸ì¸ <code class="highlighter-rouge">METoken.sol</code> ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>Example - METFaucet.sol: A faucet for METoken</p>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Version of Solidity compiler this program was written for</span>
<span class="n">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">19</span><span class="o">;</span>

<span class="kn">import</span> <span class="err">'</span><span class="nn">openzeppelin</span><span class="o">-</span><span class="n">solidity</span><span class="o">/</span><span class="n">contracts</span><span class="o">/</span><span class="n">token</span><span class="o">/</span><span class="no">ERC20</span><span class="o">/</span><span class="nc">StandardToken</span><span class="o">.</span><span class="na">sol</span><span class="err">'</span><span class="o">;</span>


<span class="c1">// A faucet for ERC20 token MET</span>
<span class="n">contract</span> <span class="nc">METFaucet</span> <span class="o">{</span>

	<span class="nc">StandardToken</span> <span class="kd">public</span> <span class="nc">METoken</span><span class="o">;</span>
	<span class="n">address</span> <span class="kd">public</span> <span class="nc">METOwner</span><span class="o">;</span>

	<span class="c1">// METFaucet constructor, provide the address of METoken contract and</span>
	<span class="c1">// the owner address we will be approved to transferFrom</span>
	<span class="n">function</span> <span class="nf">METFaucet</span><span class="o">(</span><span class="n">address</span> <span class="n">_METoken</span><span class="o">,</span> <span class="n">address</span> <span class="n">_METOwner</span><span class="o">)</span> <span class="kd">public</span> <span class="o">{</span>

		<span class="c1">// Initialize the METoken from the address provided</span>
		<span class="nc">METoken</span> <span class="o">=</span> <span class="nc">StandardToken</span><span class="o">(</span><span class="n">_METoken</span><span class="o">);</span>
		<span class="nc">METOwner</span> <span class="o">=</span> <span class="n">_METOwner</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="n">function</span> <span class="nf">withdraw</span><span class="o">(</span><span class="n">uint</span> <span class="n">withdraw_amount</span><span class="o">)</span> <span class="kd">public</span> <span class="o">{</span>

    	<span class="c1">// Limit withdrawal amount to 10 MET</span>
    	<span class="n">require</span><span class="o">(</span><span class="n">withdraw_amount</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="o">);</span>

		<span class="c1">// Use the transferFrom function of METoken</span>
		<span class="nc">METoken</span><span class="o">.</span><span class="na">transferFrom</span><span class="o">(</span><span class="nc">METOwner</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">,</span> <span class="n">withdraw_amount</span><span class="o">);</span>
    <span class="o">}</span>

	<span class="c1">// REJECT any incoming ether</span>
	<span class="n">function</span> <span class="o">()</span> <span class="n">external</span> <span class="n">payable</span> <span class="o">{</span> <span class="n">revert</span><span class="o">();</span> <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">transferFrom</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ 2ê°œì˜ ì¶”ê°€ ë³€ìˆ˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. í•˜ë‚˜ëŠ” ë°°í¬ëœ <code class="highlighter-rouge">METoken</code> ì»¨íŠ¸ë˜ê¸‘ì˜ ì£¼ì†Œë¥¼ ë³´ìœ í•˜ë©°, ë‹¤ë¥¸ í•˜ë‚˜ëŠ” <code class="highlighter-rouge">Faucet</code> ì¶œê¸ˆì„ ìŠ¹ì¸í•  MET ì†Œìœ ìì˜ ì£¼ì†Œë¥¼ ë³´ìœ í•©ë‹ˆë‹¤. <code class="highlighter-rouge">METFaucet</code> ì»¨íŠ¸ë™íŠ¸ëŠ” <code class="highlighter-rouge">METoken.transferFrom</code> ì„ í˜¸ì¶œí•˜ê³  MET ë¥¼ ì†Œìœ ìë¡œë¶€í„° <code class="highlighter-rouge">Faucet</code> ì¶œê¸ˆ ìš”ì²­ì´ ë°œìƒí•œ ì£¼ì†Œë¡œ ì´ë™í•˜ë„ë¡ ì§€ì‹œí•©ë‹ˆë‹¤.</p>

<p>ë‹¤ìŒ ë‘ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">StandardToken</span> <span class="kd">public</span> <span class="nc">METoken</span><span class="o">;</span>
<span class="n">address</span> <span class="kd">public</span> <span class="nc">METOwner</span><span class="o">;</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">Facuet</code> ì´ <code class="highlighter-rouge">METoken</code> ê³¼ <code class="highlighter-rouge">METOwner</code> ì—ëŒ€í•´ ì˜¬ë°”ë¥¸ ì£¼ì†Œë¡œ ì´ˆê¸°í™”í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì •ì˜ ìƒì„±ìë¥¼ ì„ ì–¸í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// METFaucet constructor - provide the address of the METoken contract and</span>
<span class="c1">// the owner address we will be approved to transferFrom</span>
<span class="n">function</span> <span class="nf">METFaucet</span><span class="o">(</span><span class="n">address</span> <span class="n">_METoken</span><span class="o">,</span> <span class="n">address</span> <span class="n">_METOwner</span><span class="o">)</span> <span class="kd">public</span> <span class="o">{</span>

	<span class="c1">// Initialize the METoken from the address provided</span>
	<span class="nc">METoken</span> <span class="o">=</span> <span class="nc">StandardToken</span><span class="o">(</span><span class="n">_METoken</span><span class="o">);</span>
	<span class="nc">METOwner</span> <span class="o">=</span> <span class="n">_METOwner</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ë‹¤ìŒì€ <code class="highlighter-rouge">withdraw</code> í•¨ìˆ˜ì…ë‹ˆë‹¤. <code class="highlighter-rouge">transfer</code> ë¥¼ í˜¸ì¶œí•˜ëŠ” ëŒ€ì‹ , <code class="highlighter-rouge">METFaucet</code> ì€ <code class="highlighter-rouge">METoken</code> ì—ì„œ <code class="highlighter-rouge">transferFrom</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³    <code class="highlighter-rouge">METoken</code> ì—ê²Œ MET ë¥¼ <code class="highlighter-rouge">Faucet</code> ìˆ˜ì‹ ìì—ê²Œ ì „ì†¡í•˜ë„ë¡ ìš”ì²­í•©ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Use the transferFrom function of METoken</span>
<span class="nc">METoken</span><span class="o">.</span><span class="na">transferFrom</span><span class="o">(</span><span class="nc">METOwner</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">,</span> <span class="n">withdraw_amount</span><span class="o">);</span>
</code></pre></div></div>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ <code class="highlighter-rouge">Faucet</code> ì´ ë” ì´ìƒ ì´ë”ë¥¼ ë³´ë‚´ì§€ ì•Šìœ¼ë¯€ë¡œ ì–´ëŠ ëˆ„êµ¬ë„ <code class="highlighter-rouge">METFaucet</code> ì— ì´ë”ë¥¼ ë³´ë‚´ì§€ ëª»í•˜ê²Œ í•´ì•¼í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ì´ë”ê°€ ì ê¸°ê²Œ ë˜ëŠ”ê²ƒì„ ì›ì¹˜ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// REJECT any incoming ether</span>
<span class="n">function</span> <span class="o">()</span> <span class="n">external</span> <span class="n">payable</span> <span class="o">{</span> <span class="n">revert</span><span class="o">();</span> <span class="o">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">METFaucet.sol</code> ì½”ë“œê°€ ì¤€ë¹„ë˜ë©´ migration script ë¥¼ ìˆ˜ì •í•˜ì—¬ ë°°í¬í•©ë‹ˆë‹¤. <code class="highlighter-rouge">METFaucet</code> ì€ <code class="highlighter-rouge">METoken</code> ì˜ ì£¼ì†Œì— ë”°ë¼ ë‹¤ë¥´ë¯€ë¡œ migration script ëŠ” ì¢€ ë” ë³µì¡í•´ì§‘ë‹ˆë‹¤. javascript promise ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ì»¨íŠ¸ë™íŠ¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ë°°í¬í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ <code class="highlighter-rouge">2_deploy_contract.js</code> ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="nc">METoken</span> <span class="o">=</span> <span class="n">artifacts</span><span class="o">.</span><span class="na">require</span><span class="o">(</span><span class="s">"METoken"</span><span class="o">);</span>
<span class="kt">var</span> <span class="nc">METFaucet</span> <span class="o">=</span> <span class="n">artifacts</span><span class="o">.</span><span class="na">require</span><span class="o">(</span><span class="s">"METFaucet"</span><span class="o">);</span>
<span class="kt">var</span> <span class="n">owner</span> <span class="o">=</span> <span class="n">web3</span><span class="o">.</span><span class="na">eth</span><span class="o">.</span><span class="na">accounts</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>

<span class="n">module</span><span class="o">.</span><span class="na">exports</span> <span class="o">=</span> <span class="n">function</span><span class="o">(</span><span class="n">deployer</span><span class="o">)</span> <span class="o">{</span>

	<span class="c1">// Deploy the METoken contract first</span>
	<span class="n">deployer</span><span class="o">.</span><span class="na">deploy</span><span class="o">(</span><span class="nc">METoken</span><span class="o">,</span> <span class="o">{</span><span class="nl">from:</span> <span class="n">owner</span><span class="o">}).</span><span class="na">then</span><span class="o">(</span><span class="n">function</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">// Then deploy METFaucet and pass the address of METoken and the</span>
		<span class="c1">// address of the owner of all the MET who will approve METFaucet</span>
		<span class="k">return</span> <span class="n">deployer</span><span class="o">.</span><span class="na">deploy</span><span class="o">(</span><span class="nc">METFaucet</span><span class="o">,</span> <span class="nc">METoken</span><span class="o">.</span><span class="na">address</span><span class="o">,</span> <span class="n">owner</span><span class="o">);</span>
  	<span class="o">});</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì´ì œ íŠ¸ëŸ¬í”Œì—ì„œ ëª¨ë‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. migrate ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•©ë‹ˆë‹¤. ë°°í¬ê°€ ë˜ë©´ ì²˜ìŒìœ¼ë¡œ ëª¨ë“  MET ë¥¼ <code class="highlighter-rouge">web3,eth.accounts[0]</code> ì— í• ë‹¹í•©ë‹ˆë‹¤.</p>

<p>ë‹¤ìŒìœ¼ë¡œ <code class="highlighter-rouge">METoken</code> ì˜ <code class="highlighter-rouge">approve</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ <code class="highlighter-rouge">web3.eth.accounts[0]</code> ì„ ëŒ€ì‹ í•˜ì—¬ ìµœëŒ€ 1,000 MET ê¹Œì§€ ì „ì†¡í•˜ë„ë¡ <code class="highlighter-rouge">METFaucet</code> ì„ ìŠ¹ì¸í•©ë‹ˆë‹¤.</p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ <code class="highlighter-rouge">Faucet</code> ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ <code class="highlighter-rouge">web3.eth.accounts[1]</code> ì—ì„œ <code class="highlighter-rouge">METFaucet.withdraw</code> ë¥¼ í˜¸ì¶œí•˜ê³  10 MET ë¥¼ ì¶œê¸ˆí•©ë‹ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>truffle console <span class="nt">--network</span> ganache
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> migrate
Using network <span class="s1">'ganache'</span><span class="nb">.</span>

Running migration: 1_initial_migration.js
  Deploying Migrations...
  ... 0x79352b43e18cc46b023a779e9a0d16b30f127bfa40266c02f9871d63c26542c7
  Migrations: 0xaa588d3737b611bafd7bd713445b314bd453a5c8
Saving artifacts...
Running migration: 2_deploy_contracts.js
  Replacing METoken...
  ... 0xc42a57f22cddf95f6f8c19d794c8af3b2491f568b38b96fef15b13b6e8bfff21
  METoken: 0xf204a4ef082f5c04bb89f7d5e6568b796096735a
  Replacing METFaucet...
  ... 0xd9615cae2fa4f1e8a377de87f86162832cf4d31098779e6e00df1ae7f1b7f864
  METFaucet: 0x75c35c980c0d37ef46df04d31a140b65503c0eed
Saving artifacts...
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.approve<span class="o">(</span>METFaucet.address, 100000<span class="o">)</span> <span class="o">})</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.balanceOf<span class="o">(</span>web3.eth.accounts[1]<span class="o">)</span>.then<span class="o">(</span>console.log<span class="o">)</span> <span class="o">})</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> BigNumber <span class="o">{</span> s: 1, e: 0, c: <span class="o">[</span> 0 <span class="o">]</span> <span class="o">}</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METFaucet.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.withdraw<span class="o">(</span>1000, <span class="o">{</span>from:web3.eth.accounts[1]<span class="o">})</span> <span class="o">}</span> <span class="o">)</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> METoken.deployed<span class="o">()</span>.then<span class="o">(</span>instance <span class="o">=&gt;</span>
                  <span class="o">{</span> instance.balanceOf<span class="o">(</span>web3.eth.accounts[1]<span class="o">)</span>.then<span class="o">(</span>console.log<span class="o">)</span> <span class="o">})</span>
truffle<span class="o">(</span>ganache<span class="o">)&gt;</span> BigNumber <span class="o">{</span> s: 1, e: 3, c: <span class="o">[</span> 1000 <span class="o">]</span> <span class="o">}</span>
</code></pre></div></div>

<p>ê²°ê³¼ë¥¼ ë³´ë©´ ì›Œí¬í”Œë¡œìš°ì—ì„œ <code class="highlighter-rouge">approve</code> ë° <code class="highlighter-rouge">transferFrom</code> ì„ ì‚¬ìš©í•˜ì—¬ í•œ ì»¨íŠ¸ë™íŠ¸ì—ì„œ ë‹¤ë¥¸ í† í°ì— ì •ì˜ëœ í† ì½˜ì„ ì „ì†¡í•  ìˆ˜ ìˆë„ë¡ ìŠ¹ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì œëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ERC20 í† í°ì„ EOA ë° ê¸°íƒ€ ì»¨íŠ¸ë™íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê·¸ëŸ¬ë‚˜ ERC20 í† í°ì„ ì˜¬ë°”ë¥´ê²Œ ê´€ë¦¬í•˜ëŠ” ë° ë“œëŠ” ë¶€ë‹´ì€ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ë¡œ ë„˜ê²¨ì§‘ë‹ˆë‹¤. ë§Œì•½ ì‚¬ìš©ìê°€ ERC20 í† í°ì„ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œë¡œ ì „ì†¡í•˜ë ¤ê³  ì‹œë„í•˜ëŠ”ë°, ì´ ì»¨íŠ¸ë™íŠ¸ê°€ ERC20 í† í°ì„ ë°›ì„ ì¤€ë¹„ê°€ ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ í† í°ì´ ì†ì‹¤ë©ë‹ˆë‹¤.</p>
:ET