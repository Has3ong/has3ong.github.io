---
title : Ethereum Smart Contracts and Solidity -1-
tags :
- Solidity
- Smart Contract
- Ethereum
---

## What Is a Smart Contract?

**스마트 컨트랙트(smart contract)** 라는 용어는 다양한 것들을 설명하기 위해 수년동안 사용되어왔습니다.

암호학자 *Nick Szabo* 는 이 용어를 **당사자들이 다른 약속에 따라 수행하는 프로토콜을 포함하여 디지털 형식으로 지정된 일련의 약속** 이라고 정의했다.

스마트 컨트랙트의 개념은 비트코인의 발명으로 탈중앙화 블록체인 플랫폼이 도입된 후에 진화했다. 스마트 컨트랙트 이더리움 네트워크 프로토콜의 일부인 이더리움 가상 머신의 컨텍스트상에서 결정론적으로(deterministically) 작동한다.

이제 스마트 컨트랙트의 정의를 살펴보겠습니다.

* **computer programs**
  * 스마트 컨트랙트는 단순히 컴퓨터 프로그램이다. 컨트랙트라는 단어는 이런 맥락에서 법적인 의미는 없다.
* **immutable**
  * 스마트 컨트랙트 코드는 일단 배포되면, 변경할 수 없다. 기존 소프트웨어와 달리 컨트랙트를 수정하는 유일한 방법은 새로운 인스턴스를 배포하는 것이다.
* **deterministic**
  * 스마트 컨트랙트를 실행한 결과물은 그것을 실행한 모든 이에게 동일한데, 실행을 시작한 트랜잭션의 컨텍스트와 실행 시점에 이더리움 블록체인의 상태가 동일한다는 전제가 있기 때문이다.
* **EVM context**
  * 스마트 컨트랙트는 매우 제한적인 실행 컨텍스트에서 작동된다. 이들은 자신의 상태, 호출한 트랜잭션의 컨텍스트 및 가장 최근 블로그이 일부 정보에 접근할 수 있다.
* **decentralized world computer**
  * EVM 은 모든 이더리움 노드에서 로컬 인스턴스로 실행되지만, EVM 의 모든 인스턴스는 동일한 초기 상태에서 작동하고 동일한 최종 상태를 생성하기 때문에 시스템 전체가 단일 '월드 컴퓨터'로 작동한다. 
  
## Life Cycle of a Smart Contract

스마트 컨트랙트는 일반적으로 솔리디티 같은 고급 언어로 작성됩니다. 컨트랙트를 실행하려면 EVM 에서 실행되는 저수준의 바이트 코드로 컴파일 되어야 합니다. 일단 컴파일되면 고유한 **컨트랙트 생성(contract creation)** 트랜잭션을 사용하여 이더리움 플랫폼에 배포되며, 이 트랜잭션은 고유한 컨트랙트 생성 주소, 0x0 으로 전송됩니다.

각 컨트랙트는 이더리움 주소로 식별되며, 이 주소는 원래 계정 및 논스의 함수로 컨트랙트 생성 트랜잭션에서 파생됩니다. 컨트랙트의 이더리움 주소는 트잭잭션에서 수신자로 사용되거나 컨트랙트에 자금을 보내거나 컨트랙트 함수를 호출하는 데 사용할 수 있습니다.

컨트랙트는 **트랜잭션에 의해 호출된 경우에만 실행됩니다.** 이더리움의 모든 스마트 컨트랙트는 EOA 에서 시작된 트랜잭션으로 인해 실행됩니다. 컨트랙트는 다른 컨트랙트를 호출할 수 있고 그 컨트랙트는 또 다른 컨트랙트를 호출할 수 있지만, 체안에서 첫번째 컨트랙트 실행은 항상 EOA 로부터 트랜잭션에 의해 호출됩니다. 스마트 컨트랙트는 체인의 일부분으로 트랜잭션에 의해 직접 혹은 간접적으로 호출되기 전까지는 대기 상태에 놓여 있습니다.

트랜잭션은 호출하는 컨트랙트 수 또는 호출 시 해당 컨트랙트가 수행하는 작업과 상관없이 **원자성(atmoic)** 의 특징을 지닙니다. 트랜잭션은 모든 실행이 성공적으로 종료된 경우에만 글로벌 상태의 모든 변경사항이 기록되고 전체가 실행됩니다. 성공적인 종료는 모든 프로그램이 오류 없이 실행되었음을 의미합니다. 오류로 인한 실행이 실패하면 모든 영향은 트랜잭션이 실행되지 않은 것처럼 **롤백(rolled back)** 됩니다. 실패한 트랜잭션은 여전히 시도된것으로 기도되며, 실행을 위해 가스로 소비된 어디는 원 계정에서 차감되지만, 컨트랙트 또는 계좌 상태에는 영향을 미치지 않습니다.

컨트랙트를 삭제하려면 SELFDESTRUCT 라는 EVM 연산 코드를 실행해야 합니다. 이 작업은 **음의 가스(negative gas)** 즉, 가스 환불이 일어나기 때문에 저장된 상태의 삭제로 인한 네트워크 클라이언트의 자원을 반환하도록 하는 동기부여를 만듭니다. 이 방법으로 컨트랙트를 삭제해도 컨트랙트의 트랜잭션 내역이 제거되지는 않습니다.

## Introduction to Ethereum High-Level Languages

일반적으로 프로그래밍 언어는 **선언형(declaretive)** 프로그래밍과 **명령형(imperative)** 프로그래밍이라는 2가지 프로그래밍으로 분류할 수 있습니다. **함수형(functional)** 프로그래밍과 **절차적(procedural)** 프로그래밍이라고도 합니다. 

선언형 프로그래밍에서는 프로그래밍은 프로그램이 **logic** 을 표현하지만, 그 **flow** 는 표현하지 않는 함수를 작성합니다. 선언형 프로그래밍은 **부작용(side effect)** 가 없는 프로그램을 만드는데 사용됩니다.

선언형 프로그램의 예로는 SQL 이 있습니다. 반대로 명령형 프로그래밍 언어에는 C++ 및 Java 가 있습니다.

스마트 컨트랙트에서 널리 사용되는 언어는 명령형 언어입니다.

스마트 컨트랙트에 대해 현재 지원되는 고급 프로그래밍 언어는 아래와 같습니다.

* LLL(Low-level Lisp-like Language)
* Serpent
* Solidity
* Vyper
* Bamboo